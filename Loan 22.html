<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8">
  <title>Shree Radha Credit Co-operative Society</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    /* ===== Body ===== */
    body {
      font-family: 'Poppins', sans-serif;
      background: #fefefe;
      margin: 0;
      padding: 0;
      color: #330000;
    }

    /* ===== Header ===== */
    header {
      font-family: 'Merriweather', serif;
      background: linear-gradient(90deg, #800000, #a00000);
      color: #fff;
      font-size: 28px;
      font-weight: 700;
      padding: 15px 20px;
      text-align: center;
      letter-spacing: 1px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
      position: relative;
    }

    .agent-panel {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: #fff;
      color: #800000;
      padding: 10px 15px;
      border-radius: 50%;
      font-weight: bold;
      cursor: pointer;
      border: 2px solid #fff;
      font-size: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      transition: 0.3s;
    }
    .agent-panel:hover { background: #f4f4f4; }

    /* ===== Buttons ===== */
    .action-buttons {
      margin: 30px 0;
      text-align: center;
    }
    .action-buttons button {
      width: 80%;
      max-width: 400px;
      padding: 15px;
      font-size: 18px;
      font-weight: 600;
      border-radius: 40px;
      border: none;
      color: #fff;
      background: #800000;
      box-shadow: 0 5px 15px rgba(128,0,0,0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .action-buttons button:hover {
      background: #a00000;
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(128,0,0,0.4);
    }

    /* ===== Panel ===== */
    .panel {
      display: none;
      background: #fff;
      max-width: 500px;
      margin: 30px auto;
      padding: 25px 30px;
      border-radius: 15px;
      box-shadow: 0 6px 25px rgba(128,0,0,0.15);
      transition: all 0.5s ease;
      transform: translateY(30px);
      opacity: 0;
    }
    .panel.show {
      display: block;
      transform: translateY(0);
      opacity: 1;
    }
    .panel:hover {
      box-shadow: 0 8px 30px rgba(128,0,0,0.25);
    }

    .heading {
      font-family: 'Merriweather', serif;
      font-size: 24px;
      font-weight: 700;
      color: #800000;
      margin-bottom: 20px;
      text-align: center;
      text-transform: uppercase;
      border-bottom: 2px solid #800000;
      padding-bottom: 8px;
    }

    /* ===== Inputs & Select ===== */
    input, select {
      width: 100%;
      padding: 12px 15px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }

    button {
      width: 100%;
      padding: 12px 15px;
      margin-top: 10px;
      background: #800000;
      color: #fff;
      font-weight: bold;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
    }
    button:hover {
      background: #a00000;
      transform: translateY(-2px);
    }

    #balance {
      font-weight: bold;
      color: #330000;
      font-size: 20px;
      margin: 15px 0;
      text-align: center;
    }

    p {
      font-size: 15px;
      line-height: 1.5;
      color: #330000;
      text-align: center;
    }

    /* ===== Responsive ===== */
    @media (max-width: 1024px) {
      header { font-size: 26px; }
      .action-buttons button { width: 85%; font-size: 17px; }
      .panel { max-width: 450px; padding: 20px; margin: 25px auto; }
      .heading { font-size: 22px; }
    }

    @media (max-width: 768px) {
      header { font-size: 22px; }
      .action-buttons button { width: 90%; font-size: 16px; }
      .panel { max-width: 400px; padding: 18px; margin: 20px auto; }
      .heading { font-size: 20px; }
      input, select { font-size: 15px; padding: 10px 12px; }
      #balance { font-size: 18px; }
    }

    @media (max-width: 480px) {
      header { font-size: 18px; padding: 12px 15px; }
      .agent-panel { font-size: 18px; padding: 8px 12px; right: 15px; }
      .action-buttons button { width: 95%; font-size: 15px; padding: 12px; }
      .panel { max-width: 95%; padding: 15px; margin: 15px auto; }
      .heading { font-size: 18px; }
      input, select { font-size: 14px; padding: 8px 10px; }
      #balance { font-size: 16px; }
      p { font-size: 14px; }
    }
  </style>
</head>
<body>

<header>
  Shree Radha Credit Co-operative Society, Gujri (Dhamnod)
  <div class="agent-panel" onclick="showPanel('agentLogin')">..</div>
</header>

<div class="action-buttons">
  <button onclick="showPanel('customerLogin')">‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à üôè, ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡•á‡§µ‡§æ ‡§Æ‡•á‡§Ç üíª‚ú®</button>
</div>

<!-- Customer Login -->
<div id="customerLogin" class="panel show">
  <div class="heading">Customer Login</div>
  <input id="cAccount" placeholder="Account Number" required>
  <input id="cPass" placeholder="Password (Last 4 digits)" required>
  <button onclick="customerLogin()">Check Account Balance</button>
</div>

<!-- Customer Panel -->
<div id="customerPanel" class="panel">
  <div class="heading">Welcome Customer</div>
  <p id="balance">Balance: ‚Çπ0</p>
  <p><b>Provided by: Shree Radha Credit Co-operative Society Limited, Gujri (Dhamnod)</b></p>
  <button onclick="downloadStatement()">Download Statement (PDF)</button>
</div>

<!-- Agent Login -->
<div id="agentLogin" class="panel">
  <div class="heading">Agent Security</div>
  <input id="aCode" placeholder="Enter Security Code">
  <button onclick="agentAuth()">Continue</button>
</div>

<!-- Agent Panel -->
<div id="agentPanel" class="panel">
  <div class="heading">Agent Transaction</div>
  <input id="aAccount" placeholder="Account Number">
  <input id="aAmount" type="number" placeholder="Amount">
  <select id="aType">
    <option value="credit">Credit</option>
    <option value="debit">Debit</option>
  </select>
  <input id="aID" placeholder="Agent ID">
  <button onclick="saveTransaction()">Submit</button>
  <p id="msg"></p>
  <p><b>Provided by: Shree Radha Credit Co-operative Society Limited, Gujri (Dhamnod)</b></p>
</div>

<!-- jsPDF CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxzSO3znG47OIBOMzo7pkdwXo8Yt6IBfCuFbLIWoXCROsy7EUgOKrld5R9CVqzVbT2b/exec"; 
const SECURITY_CODE = "1234";

function showPanel(id){
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('show'));
  document.getElementById(id).classList.add('show');
}

function customerLogin(){
  let acc = document.getElementById("cAccount").value;
  let pass = document.getElementById("cPass").value;
  fetch(`${API_URL}?fn=checkCustomer&account=${acc}&pass=${pass}`)
    .then(res => res.json())
    .then(data => {
      if(data.success){
        showPanel("customerPanel");
        document.getElementById("balance").innerText = "Balance: ‚Çπ" + data.balance;
      } else {
        alert("Invalid Account/Password ‚ùå");
      }
    })
    .catch(err => alert("Error connecting to server!"));
}

async function downloadStatement(){
  let acc = document.getElementById("cAccount").value;
  let pass = document.getElementById("cPass").value;
  try {
    const res = await fetch(`${API_URL}?fn=getHistory&account=${acc}&pass=${pass}`);
    const data = await res.json();
    if(!data.success){ alert("Unable to fetch statement ‚ùå"); return; }

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.setFontSize(18);
    doc.text("Shree Radha Credit Co-operative Society Limited, Gujri (Dhamnod)", 14, 20);
    doc.setFontSize(12);
    doc.text(`Account: ${acc}`, 14, 28);
    doc.text(`Balance: ‚Çπ${data.balance}`, 14, 36);
    doc.text(`Date: ${new Date().toLocaleString()}`, 14, 44);

    const tableColumn = ["Date & Time", "Amount", "Type", "Agent"];
    const tableRows = [];

    data.transactions.forEach(trx => {
      tableRows.push([trx.date, `‚Çπ${trx.amount}`, trx.type, trx.agent || "-"]);
    });

    doc.autoTable({ startY: 50, head: [tableColumn], body: tableRows });
    doc.save(`Statement_${acc}.pdf`);
  } catch(err){
    console.error(err);
    alert("Error generating PDF ‚ùå");
  }
}

function agentAuth(){
  let code = document.getElementById("aCode").value;
  if(code === SECURITY_CODE){
    showPanel("agentPanel");
  } else { alert("Wrong Security Code ‚ùå"); }
}

function saveTransaction(){
  let acc = document.getElementById("aAccount").value;
  let amt = document.getElementById("aAmount").value;
  let type = document.getElementById("aType").value;
  let id = document.getElementById("aID").value;

  fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({fn:"transaction", account:acc, amount:amt, type:type, agent:id})
  })
  .then(res => res.json())
  .then(data => {
    document.getElementById("msg").innerText = data.message;
    setTimeout(()=> document.getElementById("msg").innerText = "", 4000);
  })
  .catch(err => alert("Error connecting to server!"));
}
</script>
</body>
</html>

